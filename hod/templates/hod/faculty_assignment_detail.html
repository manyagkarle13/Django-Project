{% load static %}
<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Assigned Faculty Manager — {{ branch.name }}</title>
  <style>
    body { font-family: Arial, sans-serif; background:#f6f7f8; color:#222; padding:18px; }
    .card { background:#fff; border-radius:8px; padding:20px; box-shadow:0 2px 4px rgba(0,0,0,0.1); margin-bottom:20px; }
    h2 { margin:0 0 12px; color:#333; }
    .section-subtitle { color:#666; font-size:0.9rem; margin-bottom:16px; }
    table { width:100%; border-collapse:collapse; margin:12px 0; }
    th { background:#8ADBE9; color:white; padding:10px; text-align:left; font-weight:bold; }
    td { padding:10px; border-bottom:1px solid #ddd; }
    tr:hover { background:#f9f9f9; }
    .btn { display:inline-block; padding:10px 16px; background:#1e88e5; color:white; text-decoration:none; border-radius:4px; border:none; cursor:pointer; }
    .btn-secondary { background:#6c757d; }
    .empty-state { color:#999; font-style:italic; padding:20px; text-align:center; }
    a { color:#1e88e5; text-decoration:none; }
    a:hover { text-decoration:underline; }
  </style>
</head>
<body>
  <div class="card">
    <h2>Assigned Faculty & Submissions — {{ branch.name }}</h2>
    {% if year and semester %}
      <p class="section-subtitle">Showing assignments for Year {{ year }}, Semester {{ semester }}</p>
    {% endif %}
    
    <!-- Course Assignments Section -->
<!-- Course Assignments -->
<h3>Course Assignments</h3>

{% if assignments %}
  <table style="width:100%; border-collapse:collapse;">
    <thead>
      <tr style="background:#8ADBE9; color:#fff;">
        <th style="padding:8px;text-align:left;">Course Code</th>
        <th style="padding:8px;text-align:left;">Course Title</th>
        <th style="padding:8px;text-align:center;">Year</th>
        <th style="padding:8px;text-align:center;">Semester</th>
        <th style="padding:8px;text-align:left;">Assigned Faculty</th>
      </tr>
    </thead>
    <tbody>
      {% for a in assignments %}
        <tr>
          <td style="padding:10px 8px; font-weight:700;">{{ a.course_code }}</td>
          <td style="padding:10px 8px;">{{ a.course_title|default_if_none:"" }}</td>
          <td style="padding:10px 8px; text-align:center;">{{ a.year }}</td>
          <td style="padding:10px 8px; text-align:center;">{{ a.semester }}</td>
          <td style="padding:10px 8px;">{{ a.assigned_faculty_name }}</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
{% else %}
  <p style="color:#666">No assignments found. Use "Create Schema" to add scheme rows first.</p>
{% endif %}


    <!-- Faculty Syllabi Section -->
    <h3 style="margin-top:24px;margin-bottom:12px;">Faculty Syllabi (All)</h3>
    {% if submissions %}
      <table>
        <thead>
          <tr>
            <th>Course</th>
            <th>Faculty</th>
            <th>Status</th>
            <th>Submitted On</th>
          </tr>
        </thead>
        <tbody>
          {% for submission in submissions %}
            <tr>
              <td>{{ submission.course.course_code }} — {{ submission.course.course_title }}</td>
              <td>{{ submission.faculty.get_full_name|default:submission.faculty.username }}</td>
              <td>{{ submission.status|default:"PENDING" }}</td>
              <td>{{ submission.submitted_at|date:"d M Y" }}</td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    {% else %}
      <p class="empty-state">No syllabus submissions found.</p>
    {% endif %}

    <!-- Action Buttons -->
    <div style="margin-top:20px;">
      <a href="{% url 'hod:dashboard_self' branch_id %}" class="btn btn-secondary">Back to Dashboard</a>
      <a href="{% url 'hod:generate_full_pdf' branch_id %}" class="btn" style="margin-left:8px;">Create Combined Syllabus (Approved only)</a>
    </div>
  </div>
</body>
</html>
