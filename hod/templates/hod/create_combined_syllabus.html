{% extends "base.html" %}
{% block content %}
<h2>Create Combined Syllabus</h2>
<form method="post" action="{% if branch %}{% url 'hod:generate_combined_syllabus' branch.pk %}{% elif branch_pk %}{% url 'hod:generate_combined_syllabus' branch_pk %}{% else %}{{ request.path }}{% endif %}">
  {% csrf_token %}
  <input type="hidden" name="year" value="{{ year }}">
  <input type="hidden" name="semester" value="{{ semester }}">

  <div class="mb-3">
    <label class="form-label">Include HOD Scheme (optional)</label>
    <div class="input-group">
      <div class="input-group-text">
        <input type="checkbox" name="include_hod" id="include_hod">
      </div>
      <select name="scheme_id" class="form-select">
        <option value="">-- choose scheme to include --</option>
        {% for s in schemes %}
          <option value="{{ s.pk }}">{{ s.branch_name }} - {{ s.title }} ({{ s.year }} Sem{{ s.semester }})</option>
        {% endfor %}
      </select>
    </div>
  </div>

  <h4>Approved Faculty PDFs</h4>
  {% if approved_pdfs %}
    {% for p in approved_pdfs %}
      <div class="form-check">
        <input class="form-check-input" type="checkbox" name="submissions" value="{{ p.pk }}" id="submission_{{ p.pk }}">
        <label class="form-check-label" for="submission_{{ p.pk }}">
          {% if p.course %}{{ p.course.course_code }}{% else %}{{ p.title }}{% endif %} — {% if p.course %}{{ p.course.course_title }}{% else %}{{ p.title }}{% endif %} — {{ p.created_by.get_full_name|default:p.created_by.username }} — Uploaded {{ p.created_at|date:"M j, Y, g:i a" }}
        </label>
      </div>
    {% endfor %}
  {% else %}
    <p>No approved PDFs found for the selected filters.</p>
  {% endif %}

  <button class="btn btn-primary mt-3" type="submit">Generate Complete PDF</button>
</form>
{% endblock %}
