{% extends 'base.html' %}
{% load static %}
{% block content %}
<style>
  body { font-family: Arial, Helvetica, sans-serif; background: #f6f7f9; margin: 0; padding: 0; }
  .card { max-width: 900px; margin: 50px auto; background: #fff; padding: 30px; border-radius: 8px; box-shadow: 0 8px 24px rgba(0,0,0,.06); }
  h1 { margin: 0 0 8px; font-size: 28px; }
  .small { font-size: 13px; color: #666; margin-bottom: 24px; display: block; }
  label { display: block; margin-top: 10px; font-weight: 600; }
  input, select, textarea { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; margin-top: 6px; box-sizing: border-box; }
  .row { display: flex; gap: 20px; flex-wrap: wrap; margin-bottom: 20px; }
  .col-2 { flex: 1 1 48%; }
  .actions { margin-top: 24px; display: flex; gap: 10px; align-items: center; }
  .btn { padding: 10px 14px; border-radius: 6px; border: 0; cursor: pointer; font-weight: 600; }
  .btn-save { background: #b72b3f; color: #fff; }
  .btn-gen { background: #9d2330; color: #fff; }
  .link { color: #123e77; text-decoration: underline, font-size: 13px; }
  .alert { padding: 12px 16px; border-radius: 6px; margin-bottom: 16px; background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
</style>

<div class="card">
  {% if messages %}
    <div style="margin-bottom:20px;">
      {% for message in messages %}
        <div class="alert">{{ message }}</div>
      {% endfor %}
    </div>
  {% endif %}

  <h1>{% if editing_credit %}Edit{% else %}Add{% endif %} Semester Credits</h1>
  <span class="small">Define credits for a specific admission year and semester.</span>

  <form method="post" action="">
    {% csrf_token %}

    <label style="font-weight:600;display:block;margin-bottom:6px">Branch</label>
    <select name="branch" required style="margin-bottom:20px; padding:12px;">
      <option value="">-- Select Branch --</option>
      {% for b in branches %}
        {% if initial.branch %}
          <option value="{{ b.pk }}" {% if initial.branch|stringformat:"s" == b.pk|stringformat:"s" %}selected{% endif %}>{{ b.code }} — {{ b.name }}</option>
        {% elif editing_credit and editing_credit.branch %}
          <option value="{{ b.pk }}" {% if editing_credit.branch.pk == b.pk %}selected{% endif %}>{{ b.code }} — {{ b.name }}</option>
        {% else %}
          <option value="{{ b.pk }}">{{ b.code }} — {{ b.name }}</option>
        {% endif %}
      {% endfor %}
    </select>

    <label style="margin-top:12px; font-weight:600;display:block;margin-bottom:6px">Admission Year</label>
    <input name="ar" placeholder="e.g. 2024-2025" required style="margin-bottom:24px; padding:12px; width:300px;"
           value="{% if initial.admission_year %}{{ initial.admission_year }}{% elif editing_credit and editing_credit.admission_year %}{{ editing_credit.admission_year }}{% endif %}">

    <h3 style="margin-top:8px">Semester Credits</h3>
    <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:10px;max-width:760px;">
      <div>
        <label style="display:block;font-weight:600">Sem 1</label>
        <input name="sem_1" type="text" placeholder="credits" style="padding:8px;width:100%;"
          value="{% if initial.sem_1 %}{{ initial.sem_1 }}{% elif editing_credit and editing_credit.sem1 %}{{ editing_credit.sem1 }}{% endif %}">
      </div>
      <div>
        <label style="display:block;font-weight:600">Sem 2</label>
        <input name="sem_2" type="text" placeholder="credits" style="padding:8px;width:100%;"
          value="{% if initial.sem_2 %}{{ initial.sem_2 }}{% elif editing_credit and editing_credit.sem2 %}{{ editing_credit.sem2 }}{% endif %}">
      </div>
      <div>
        <label style="display:block;font-weight:600">Sem 3</label>
        <input name="sem_3" type="text" placeholder="credits" style="padding:8px;width:100%;"
          value="{% if initial.sem_3 %}{{ initial.sem_3 }}{% elif editing_credit and editing_credit.sem3 %}{{ editing_credit.sem3 }}{% endif %}">
      </div>
      <div>
        <label style="display:block;font-weight:600">Sem 4</label>
        <input name="sem_4" type="text" placeholder="credits" style="padding:8px;width:100%;"
          value="{% if initial.sem_4 %}{{ initial.sem_4 }}{% elif editing_credit and editing_credit.sem4 %}{{ editing_credit.sem4 }}{% endif %}">
      </div>
      <div>
        <label style="display:block;font-weight:600">Sem 5</label>
        <input name="sem_5" type="text" placeholder="credits" style="padding:8px;width:100%;"
          value="{% if initial.sem_5 %}{{ initial.sem_5 }}{% elif editing_credit and editing_credit.sem5 %}{{ editing_credit.sem5 }}{% endif %}">
      </div>
      <div>
        <label style="display:block;font-weight:600">Sem 6</label>
        <input name="sem_6" type="text" placeholder="credits" style="padding:8px;width:100%;"
          value="{% if initial.sem_6 %}{{ initial.sem_6 }}{% elif editing_credit and editing_credit.sem6 %}{{ editing_credit.sem6 }}{% endif %}">
      </div>
      <div>
        <label style="display:block;font-weight:600">Sem 7</label>
        <input name="sem_7" type="text" placeholder="credits" style="padding:8px;width:100%;"
          value="{% if initial.sem_7 %}{{ initial.sem_7 }}{% elif editing_credit and editing_credit.sem7 %}{{ editing_credit.sem7 }}{% endif %}">
      </div>
      <div>
        <label style="display:block;font-weight:600">Sem 8</label>
        <input name="sem_8" type="text" placeholder="credits" style="padding:8px;width:100%;"
          value="{% if initial.sem_8 %}{{ initial.sem_8 }}{% elif editing_credit and editing_credit.sem8 %}{{ editing_credit.sem8 }}{% endif %}">
      </div>
    </div>

    <div class="actions">
      <button type="submit" name="action" value="save" class="btn btn-save">Save</button>
      <button type="submit" name="action" value="generate" class="btn btn-gen">Save & Generate PDF</button>
      <a href="{% url 'academics:dean_dashboard' %}" class="link">Cancel / Back</a>
    </div>
  </form>
</div>
{% endblock %}
